<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="google" content="notranslate" />
  <title>Hoofdrekenen</title>

  <!-- Gebruik gerust je eigen CSS als die bestaat -->
  <!-- <link rel="stylesheet" href="./hoofdrekenen.css"> -->

  <style>
    :root{
      --ink:#0b4d7a;
      --bg:#f4f6f8;
      --card:#ffffff;
      --line:#d7e2ea;
      --muted:#5b6b77;
      --btn:#0b4d7a;
      --btn2:#eef3f7;
    }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg);
      color:#111;
    }
    .wrap{
      max-width: 1400px;
      margin: 0 auto;
      padding: 16px;
    }
    .topbar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:12px;
    }
    .topbar h1{
      margin:0;
      font-size:22px;
      color:var(--ink);
    }
    .layout{
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:16px;
      align-items:start;
    }
    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:14px;
      padding:14px;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
    }
    .hint{
      font-size:13px;
      color:var(--muted);
      margin: 0 0 10px 0;
      line-height:1.35;
    }
    .melding{
      min-height:18px;
      font-size:13px;
      color:#b00020;
      margin: 6px 0 10px 0;
    }

    .group{
      margin-bottom:12px;
    }
    .group-title{
      font-weight:700;
      color:var(--ink);
      margin: 0 0 6px 0;
      font-size:14px;
    }
    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    label{
      font-size:14px;
    }
    input[type="number"], select, textarea{
      width:100%;
      padding:8px 10px;
      border:1px solid #cfd8dc;
      border-radius:10px;
      background:#fff;
      font-size:14px;
      box-sizing:border-box;
    }
    textarea{ resize: vertical; }

    .inline{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
    }
    .inline label{ display:flex; gap:8px; align-items:center; }

    details{
      border:1px solid var(--line);
      border-radius:12px;
      padding:10px 12px;
      background:#fafcff;
      margin:10px 0;
    }
    summary{
      cursor:pointer;
      font-weight:700;
      color:var(--ink);
      list-style:none;
    }
    summary::-webkit-details-marker{ display:none; }

    .checks{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:6px 10px;
      margin-top:10px;
    }
    .checks label{
      display:flex;
      gap:8px;
      align-items:center;
      font-size:14px;
      color:#111;
    }

    .btnrow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:12px;
    }
    button{
      border:0;
      border-radius:12px;
      padding:10px 12px;
      font-weight:700;
      cursor:pointer;
      font-size:14px;
    }
    .btn-primary{
      background:var(--btn);
      color:#fff;
    }
    .btn-secondary{
      background:var(--btn2);
      color:#111;
      border:1px solid var(--line);
    }

    .previewcard{
      padding:0;
      overflow:hidden;
    }
    .previewhead{
      padding:12px 14px;
      border-bottom:1px solid var(--line);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      background:#fff;
    }
    .previewhead .title{
      font-weight:800;
      color:var(--ink);
    }
    iframe{
      width:100%;
      height: calc(100vh - 160px);
      border:0;
      display:block;
      background:#fff;
    }

    /* klein, maar handig */
    .subhint{
      font-size:12px;
      color:var(--muted);
      margin-top:6px;
      line-height:1.35;
    }

    /* responsief */
    @media (max-width: 1100px){
      .layout{ grid-template-columns: 1fr; }
      iframe{ height: 70vh; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <h1>Hoofdrekenen (+, ‚àí)</h1>
      <!-- eventueel een terugknop, als jij die gebruikt in je project -->
      <!-- <a class="btn-secondary" href="../dashboard/dashboard.html" style="text-decoration:none;padding:10px 12px;border-radius:12px;border:1px solid var(--line);">Terug naar dashboard</a> -->
    </div>

    <div class="layout">

      <!-- ===================== KEUZES ===================== -->
      <div class="card" id="keuzesCard">
        <p class="hint">
          Maak hier uw keuzes. U blijft op deze pagina om de preview te controleren.
          Pas aan tot het goed zit, en voeg dan pas toe aan de grote bundel.
        </p>

        <div id="rekenMelding" class="melding"></div>

<div id="brugInfo" style="display:none; margin-bottom:10px; font-size:13px; color:#b00020;">
 ‚ö†Ô∏è <strong>Let op:</strong><br>
Oefeningen van het type <strong>T ‚àí E</strong> en <strong>T ‚àí TE</strong>
worden meestal als <strong>brugoefeningen</strong> aangeleerd.<br>
Wilt u deze oefeningen gebruiken? Kies dan <strong>‚Äòmet brug‚Äô</strong> of
<strong>‚Äòbeide‚Äô</strong> bij <em>Brug</em>.

</div>

        <!-- Aantal -->
        <div class="group">
          <div class="group-title">Aantal oefeningen</div>
          <!-- ID gelijk aan versie 2 -->
          <input id="numOefeningen_reken" type="number" min="1" max="200" value="20" />
        </div>

        <!-- Oefenen tot -->
        <div class="group">
          <div class="group-title">Oefenen tot</div>
          <select id="rekenMaxGetal">
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="20" selected>20</option>
            <option value="100">100</option>
            <option value="1000">1000</option>
          </select>
          <div class="subhint">
            De somtypes hieronder worden automatisch gefilterd op basis van ‚ÄúOefenen tot‚Äù.
          </div>
        </div>

        <!-- Type bewerking -->
        <div class="group">
          <div class="group-title">Type bewerking</div>
          <div class="inline">
            <label><input type="radio" name="rekenType" value="optellen" checked> Optellen</label>
            <label><input type="radio" name="rekenType" value="aftrekken"> Aftrekken</label>
            <label><input type="radio" name="rekenType" value="beide"> Beide</label>
          </div>
        </div>

        <!-- Brug -->
        <div class="group">
          <div class="group-title">Brug</div>
          <!-- ID gelijk aan versie 2 -->
          <select id="rekenBrug">
            <option value="beide" selected>Beide toegestaan</option>
            <option value="met">Enkel m√©t brug</option>
            <option value="zonder">Enkel z√≥nder brug</option>
          </select>
        </div>

<!-- Soort brug (alleen bij tot 1000 + met brug) -->
<div class="group" id="brugSoortWrap" style="display:none;">
  <div class="group-title">Soort brug</div>

  <label style="display:flex;gap:8px;align-items:center;">
    <input type="checkbox" id="brugTiental" checked>
    Brug naar het tiental
  </label>

  <label style="display:flex;gap:8px;align-items:center;margin-top:4px;">
    <input type="checkbox" id="brugHonderdtal" checked>
    Brug naar het honderdtal
  </label>

  <label style="display:flex;gap:8px;align-items:center;margin-top:4px;">
    <input type="checkbox" id="brugMeervoudig">
    Meervoudige brug (gevorderd)
  </label>
</div>

        <!-- Hulpmiddelen -->
        <div class="group">
          <label style="display:flex;gap:8px;align-items:center;">
            <input type="checkbox" id="rekenHulpCheckbox">
            Hulpmiddelen tonen (alleen bij brug)
          </label>
        </div>

        <!-- Detail hulpmiddelen (zoals versie 2) -->
        <div class="group" id="rekenHulpDetail" style="display:none;">
          <div class="group-title">Instellingen hulpmiddelen</div>

          <div id="optellenHint" class="subhint" style="margin-bottom:6px;">
            Bij optellen komen <b>splitsbenen onder de tweede term</b>.
          </div>

          <div id="aftrekkenHint" style="margin-bottom:6px;display:none;">
            <div class="subhint" style="margin-bottom:6px;">
              Kies waar de <b>splitsbenen</b> staan bij aftrekken:
            </div>
            <!-- naam gelijk aan versie 2 -->
            <label style="display:flex;gap:8px;align-items:center;">
              <input type="radio" name="splitsPlaatsAftrekken" value="onderAftrektal" checked>
              Onder het aftrektal
            </label>
            <label style="display:flex;gap:8px;align-items:center;margin-top:4px;">
              <input type="radio" name="splitsPlaatsAftrekken" value="onderAftrekker">
              Onder de aftrekker
            </label>
          </div>

          <!-- Schrijflijnen (dit miste je: nu terug zoals versie 2) -->
          <label style="display:flex;gap:8px;align-items:center;margin-top:8px;">
            <input type="checkbox" id="rekenHulpSchrijflijnen" checked>
            Twee schrijflijnen rechts voor tussenstappen
          </label>

          <!-- Hulpmiddel-stijl (splitsbenen / compenseren) -->
          <div class="group" style="margin-top:10px;">
            <div class="group-title">Hulpmiddel-stijl</div>
            <div class="inline">
              <label><input type="radio" name="rekenHulpStijl" value="splitsbenen" checked> Splitsbenen</label>
              <label><input type="radio" name="rekenHulpStijl" value="compenseren"> Compenseren</label>
            </div>
          </div>
<div class="group" id="compenseerModusWrap" style="display:none; margin-top:8px;">
  <div class="group-title">Compenseren ‚Äì begeleiding</div>

  <label style="display:flex;gap:8px;align-items:center;">
    <input type="radio" name="compenseerModus" value="begeleid" checked>
    Begeleid (kring + vak)
  </label>

  <label style="display:flex;gap:8px;align-items:center;margin-top:4px;">
    <input type="radio" name="compenseerModus" value="half">
    Half-begeleid (geen kring, wel vak)
  </label>

  <label style="display:flex;gap:8px;align-items:center;margin-top:4px;">
    <input type="radio" name="compenseerModus" value="zelfstandig">
    Zelfstandig (leerling kiest zelf)
  </label>
</div>

          <div id="compenseerVoorbeeldWrap" style="display:none; margin-top:8px;">
  <label style="display:flex;gap:8px;align-items:center;">
    <input type="checkbox" id="rekenHulpVoorbeeld">
    Voorbeeldoefening tonen (eerste oefening uitgewerkt)
  </label>
</div>

<div id="compenseerTekensWrap" style="display:none; margin-top:6px;">
  <label style="display:flex;gap:8px;align-items:center;">
    <input type="checkbox" id="rekenHulpTekens">
    + en ‚àí tonen bij compenseren
  </label>
</div>

        </div>
     <!-- Somtypes (zoals versie 2), maar overzichtelijk per bereik -->
        <details open>
          <summary>Somtypes</summary>

          <!-- Tot 20 -->
<div class="group" data-somgroep="20">
  <div class="group-title">Tot 20</div>
  <div class="checks">

    <label>
      <input type="checkbox" name="somType" value="E+E" checked>
      E + E / E ‚àí E
    </label>

    <label>
      <input type="checkbox" name="somType" value="T+E">
      T + E / T ‚àí E
    </label>

    <label>
      <input type="checkbox" name="somType" value="TE+E">
      TE + E / TE - E
    </label>

    <label>
      <input type="checkbox" name="somType" value="TE-TE">
      TE ‚àí TE
    </label>

    <label>
      <input type="checkbox" name="somType" value="T-TE">
      T ‚àí TE
    </label>

  </div>
</div>


          <!-- Tot 100 -->
          <div class="group" data-somgroep="100">
            <div class="group-title">Tot 100</div>
            <div class="checks">
              <label><input type="checkbox" name="somType" value="E+E" checked> E + E / E ‚àí E</label>
              <label><input type="checkbox" name="somType" value="T+E" checked> T + E / T ‚àí E</label>
              <label><input type="checkbox" name="somType" value="T+T" checked> T + T / T ‚àí T</label>
              <label><input type="checkbox" name="somType" value="TE+E" checked> TE + E / TE ‚àí E</label>
              <label><input type="checkbox" name="somType" value="TE+T" checked> TE + T / TE ‚àí T</label>
              <label><input type="checkbox" name="somType" value="TE+TE" checked> TE + TE / TE ‚àí TE</label>
           <label>
  <input type="checkbox" name="somType" value="T+TE">
  T + TE / T ‚àí TE
</label>

            </div>
          </div>

          <!-- Tot 1000 -->
          <div class="group" data-somgroep="1000">
            <div class="group-title">Tot 1000</div>
            <div class="checks">
              <label><input type="checkbox" name="somType" value="T+T" checked> T + T / T ‚àí T</label>
              <label>
  <input type="checkbox" name="somType" value="TE+T">
  TE + T / TE - T
</label>
              <label><input type="checkbox" name="somType" value="TE+TE" checked> TE + TE / TE ‚àí TE</label>
              <label><input type="checkbox" name="somType" value="H+H" checked> H + H / H ‚àí H</label>
              <label>
  <input type="checkbox" name="somType" value="HT+T">
  HT + T / HT - T
</label>
              <label><input type="checkbox" name="somType" value="HT+HT" checked> HT + HT / HT ‚àí HT</label>
              <label><input type="checkbox" name="somType" value="HTE+H"> HTE + H / HTE ‚àí H</label>
              <label><input type="checkbox" name="somType" value="HTE+HT"> HTE + HT / HTE ‚àí HT</label>
              <label><input type="checkbox" name="somType" value="HTE+HTE" checked> HTE + HTE / HTE ‚àí HTE</label>
            </div>
          </div>

          <div class="subhint">
            Tip: u hoeft niet alles aan te vinken. Minder somtypes = meer consistentie in het werkblad.
          </div>
        </details>
        <!-- Opdrachtzin -->
        <div class="group">
          <div class="group-title">Opdrachtzin (optioneel)</div>
          <textarea id="opdracht_reken" rows="2" placeholder="vb. Los de sommen op." style="width:100%;"></textarea>
        </div>

        <!-- Acties -->
        <div class="btnrow">
          <!-- ID‚Äôs zoals in je oude knoppenlogica-stijl -->
          <button id="maakRekenBtn" class="btn-primary">Maak preview</button>
          <button id="voegRekenToeBtn" class="btn-secondary">Voeg toe aan bundel</button>
          <button id="wisRekenPreviewBtn" class="btn-secondary" title="Maakt het overzicht terug leeg (alleen preview-stand)">Wis preview (leeg)</button>
        </div>
        <div id="brugInfoOnder"
     class="melding"
     style="display:none; margin-top:8px;">
</div>


        <div class="subhint" style="margin-top:10px;">
          In de preview kunt u per opdracht een üóë verwijderen (volledige opdracht/segment),
          en per oefening een √ó verwijderen ‚Äî net zoals u gewend was.
        </div>
      </div>

      <!-- ===================== PREVIEW ===================== -->
      <div class="card previewcard">
        <div class="previewhead">
          <div class="title">Preview (hoofdrekenen)</div>
          <div class="subhint" style="margin:0;">
            Tip: als u veel testte, gebruik ‚ÄúWis preview‚Äù.
          </div>
        </div>

        <iframe id="previewFrame" src="hoofdrekenen_preview.html"></iframe>
      </div>

    </div>
  </div>

  <!-- Je bestaande JS in /hoofdrekenen -->
  <script src="./hoofdrekenen.js"></script>

  <!-- Mini-UI helper: show/hide hulpdetail + somtype-groepen filteren.
       Dit stoort je huidige logica niet; het maakt de pagina gewoon overzichtelijker. -->
  <script>
    (function(){
      const hulpCb = document.getElementById('rekenHulpCheckbox');
      const hulpDetail = document.getElementById('rekenHulpDetail');
      const aftrekHint = document.getElementById('aftrekkenHint');
      const optelHint = document.getElementById('optellenHint');
      const maxSel = document.getElementById('rekenMaxGetal');
      const brugSel = document.getElementById('rekenBrug');


      function updateHulpUI(){
  const aan = !!hulpCb.checked;
  hulpDetail.style.display = aan ? '' : 'none';

  const stijl =
    document.querySelector('input[name="rekenHulpStijl"]:checked')?.value;

  const voorbeeldWrap = document.getElementById('compenseerVoorbeeldWrap');
  const tekensWrap = document.getElementById('compenseerTekensWrap');

  const toonComp = aan && stijl === 'compenseren';

  if (voorbeeldWrap) voorbeeldWrap.style.display = toonComp ? '' : 'none';
  if (tekensWrap) tekensWrap.style.display = toonComp ? '' : 'none';

  updateBewerkingHint();
}


      function updateBewerkingHint(){
        const type = (document.querySelector('input[name="rekenType"]:checked') || {}).value || 'optellen';
        if (!hulpCb.checked){
          aftrekHint.style.display = 'none';
          optelHint.style.display = 'none';
          return;
        }
        if (type === 'aftrekken'){
          aftrekHint.style.display = '';
          optelHint.style.display = 'none';
        } else if (type === 'optellen'){
          aftrekHint.style.display = 'none';
          optelHint.style.display = '';
        } else {
          // Beide: toon beide hints (compact)
          aftrekHint.style.display = '';
          optelHint.style.display = '';
        }
      }

      function filterSomgroepen(){
        const max = parseInt(maxSel.value || '20', 10);
        const groepen = document.querySelectorAll('[data-somgroep]');
        groepen.forEach(g => {
          const gMax = parseInt(g.getAttribute('data-somgroep'), 10);
          // toon alleen de relevante groep(en):
          // 20 -> toon 20
          // 100 -> toon 100 (en eventueel 20 niet nodig)
          // 1000 -> toon 1000
          g.style.display = (gMax === max) ? '' : 'none';
        });
      }

     hulpCb?.addEventListener('change', updateHulpUI);

document
  .querySelectorAll('input[name="rekenHulpStijl"]')
  .forEach(r => r.addEventListener('change', updateHulpUI));

document.addEventListener('change', updateBrugInfo);

document.querySelectorAll('input[name="rekenType"]').forEach(r => {
  r.addEventListener('change', updateBewerkingHint);
});
maxSel?.addEventListener('change', filterSomgroepen);


      // Wis preview: dit is enkel een ‚ÄúUI-hulpknop‚Äù.
      // Je hoofdrekenen.js mag dit overschrijven als jij het anders wil aanpakken.
      document.getElementById('wisRekenPreviewBtn')?.addEventListener('click', () => {
        if (!confirm('Preview leegmaken? (Dit verwijdert de huidige hoofdrekenen-segmenten uit je bundelopslag.)')) return;
        // We wissen enkel de bundel die voor dit bouwen gebruikt wordt.
        // Als jij per module een aparte key gebruikt, pas dit dan aan.
        // (Standaard in jouw systeem is dit 'werkbladBundel')
        localStorage.setItem('werkbladBundel', '[]');
        // Herlaad iframe + pagina
        const fr = document.getElementById('previewFrame');
        if (fr) fr.src = fr.src;
      });

function updateBrugInfo() {
  const type = document.querySelector('input[name="rekenType"]:checked')?.value;
  const brug = document.getElementById('rekenBrug')?.value;

  const aangeklikt = [...document.querySelectorAll('input[name="somType"]:checked')]
    .map(cb => cb.value);

  const heeftTE = aangeklikt.includes('T+E');
  const heeftTTE = aangeklikt.includes('T+TE');

  const boven = document.getElementById('brugInfo');
  const onder = document.getElementById('brugInfoOnder');

  const tonen =
    type === 'aftrekken' &&
    brug === 'zonder' &&
    (heeftTE || heeftTTE);

  if (boven) boven.style.display = tonen ? 'block' : 'none';

  if (onder) {
    onder.innerHTML =
      '‚ö†Ô∏è <strong>Let op:</strong><br>' +
      'Oefeningen van het type <strong>T ‚àí E</strong> en <strong>T ‚àí TE</strong> ' +
      'zijn <strong>brugoefeningen</strong>.<br>' +
      'Kies <strong>‚Äòmet brug‚Äô</strong> of <strong>‚Äòbeide‚Äô</strong> om ze te gebruiken.';
    onder.style.display = tonen ? 'block' : 'none';

    if (tonen) {
      onder.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }
  }
}



      updateHulpUI();
      filterSomgroepen();
      updateBrugInfo();
      // === Soort brug tonen/verbergen (alleen bij tot 1000 + met brug)
const brugSoortWrap = document.getElementById('brugSoortWrap');

function updateBrugSoortUI() {
  const max = parseInt(maxSel.value, 10);
  const brug = brugSel.value;

  if (max === 1000 && brug === 'met') {
    brugSoortWrap.style.display = '';
  } else {
    brugSoortWrap.style.display = 'none';
  }
}

maxSel.addEventListener('change', updateBrugSoortUI);
brugSel.addEventListener('change', updateBrugSoortUI);

// init bij laden
updateBrugSoortUI();

    })();
  </script>
</body>
</html>
